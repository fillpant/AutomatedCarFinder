<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Gallery</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #333; /* Dark background color */
            color: #fff; /* Text color */
        }
    </style>   
    <script src="https://cdn.jsdelivr.net/npm/handlebars@latest/dist/handlebars.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.0/lazysizes.min.js"></script>
</head>
<body>
<div class="container mt-5" id="listings">
</div>

<script id="listingTemplate" type="text/x-handlebars-template">
	{{#each results}}
		<center><h2>{{crawler}}</h2></center>
		<center><h5>Results: {{listingCount}}</h5></center>
		<hr>
		{{#each listings}}
			<div class="row mb-3">
	            <div class="col-md-4">
					{{#if (eq imageCnt 0)}}
	            		<img data-src="https://www.salonlfc.com/wp-content/uploads/2018/01/image-not-found-1-scaled.png" class="d-block w-100 lazyload">
	            	{{else if (eq imageCnt 1)}}
	            		<img data-src="{{imageUrls.[0]}}" class="d-block w-100 lazyload">
	            	{{else}}
	                <div id="gal_{{listingUid}}" class="carousel slide" {{#if autoScrollImages}}data-bs-ride="carousel"{{/if}}>
	                  <ol class="carousel-indicators">
	                  	{{#each imageUrls}}
	                  	<li data-bs-target="#gal_{{../listingUid}}" data-bs-slide-to="{{@index}}" {{#unless @index}}class="active"{{/unless}}></li>
	                    {{/each}}
	                  </ol>
	                  <div class="carousel-inner">
	                  	{{#each imageUrls}}
	                    <div class="carousel-item{{#unless @index}} active{{/unless}}">
	                       <img data-src="{{this}}" class="d-block w-100 lazyload">
	                    </div>
	                    {{/each}}
	                  </div>
	                  <a class="carousel-control-prev" href="#gal_{{listingUid}}" role="button" data-bs-slide="prev">
	                  <span class="carousel-control-prev-icon" aria-hidden="true"></span>
	                  </a>
	                  <a class="carousel-control-next" href="#gal_{{listingUid}}" role="button" data-bs-slide="next">
	                  <span class="carousel-control-next-icon" aria-hidden="true"></span>
	                  </a>
	               </div>
					{{/if}}
	            </div>
				<div class="col-md-6">
	            	<a href="{{listingUrl}}" target="_blank">View Listing</a>
					<p style="white-space: pre-wrap">{{shortDescription}}</p>
				</div>
	         </div>
	      </div>
	    {{/each}}
    {{/each}}
</script>

<script>
	async function applyTemplate() {
		Handlebars.registerHelper('eq', function (a,b) {
		  return a==b;
		});
		var templ = Handlebars.compile(document.getElementById("listingTemplate").innerHTML);
		const url = "./cars.json";
		const response = await fetch(url);
		const jsn = await response.json();
		console.log(jsn);
		var rendered = templ(jsn);
		document.getElementById("listings").innerHTML=rendered;
	}
	applyTemplate();
</script>

</body>
</html>
